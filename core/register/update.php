<html>

<head>
  <title>MNIT Student Fees Confirmation</title>
  <script language="JavaScript" src="js/gen_validatorv2.js" type="text/javascript"></script>
</head>

<?php
    if (!isset($_POST['updatethis'])) {
?>
<body bgcolor="#FFFFFF" link="#2080D0" vlink="#0060B0" alink="#000000" marginheight="10">
  <table align="center" border="0" width="75%" cellspacing="0" cellpadding="3">
    <tr>
      <td width="100%" valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="2">
                <tr>
                  <td width="92%" nowrap bgcolor="#FFE880"><b>MNIT Online Registration (Even Semester) 2007</b></td>

                  <td width="8%" align="right" valign="bottom" nowrap bgcolor="#FFE880">
                    <small><b>Fee Confirmation Form</b></small>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="1">
                <tr>
                  <td bgcolor="#C080F0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="1">
                <tr>
                  <td bgcolor="#FFC040"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="1">
                <tr>
                  <td bgcolor="#80C0F0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="1">
                <tr>
                  <td bgcolor="#80F0C0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td valign="bottom">
        <table border="0" width="100%" cellspacing="0" cellpadding="2">
          <tr>
            <td bgcolor="#000000">
              <table border="0" width="100%" cellspacing="0" cellpadding="1">
                <tr>
                  <td bgcolor="#F09090"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>

  <table align="center" width="75%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top">
        <table border="0" width="100%" cellspacing="0" cellpadding="3">
          <tr>
            <td>
              <table border="0" width="*%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="1">
                      <tr>
                        <td bgcolor="#C080F0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <tr>
            <td>
              <table border="0" width="*%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="1">
                      <tr>
                        <td bgcolor="#FFC040"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <tr>
            <td>
              <table border="0" width="*%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="1">
                      <tr>
                        <td bgcolor="#80C0F0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <tr>
            <td>
              <table border="0" width="*%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="1">
                      <tr>
                        <td bgcolor="#80F0C0"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <tr>
            <td>
              <table border="0" width="*%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="1">
                      <tr>
                        <td bgcolor="#F09090"><font size="-2">&nbsp;&nbsp;&nbsp;</font></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td width="100%" valign="top">
        <table width="100%" border="0" cellspacing="0" cellpadding="3">
          <tr>
            <td>
              <table border="0" width="100%" cellspacing="0" cellpadding="2">
                <tr>
                  <td bgcolor="#000000">
                    <table border="0" width="100%" cellspacing="0" cellpadding="3">
                      <tr>
                        <td valign="top" bgcolor="#E0E0E0">
                          <p align="justify"><font face="Verdana, Arial, Helvetica, sans-serif">Enter following details and password to update student payment:</font></p>

                          <form name="updater" method="post" action="update.php">
                            <table width="100%" border="0">
                              <tr>
                                <td width="243"><font face="Arial, Helvetica, sans-serif">Student ID:</font></td>
                                <td width="437"><input name="userid" type="text" id="userid" size="8" maxlength="6"></td>
                              </tr>

                              <tr>
                                <td><font face="Arial, Helvetica, sans-serif">Fee Type:</font></td>
                                <td>
                                    <font face="Verdana, Arial, Helvetica, sans-serif">
                                    <select name="fee" id="fee">
                                        <option value="0">
                                            Select Fee Category
                                        </option>

                                        <option value="GD">
                                            General Day Scholar (5100)
                                        </option>

                                        <option value="GH">
                                            General Hosteller (6200)
                                        </option>

                                        <option value="SD">
                                            SC/ST/Girls Day Scholar (100)
                                        </option>

                                        <option value="SH">
                                            SC/ST/Girls Hosteller (1200)
                                        </option>

                                        <option value="DA">
                                            DASA (100)
                                        </option>
                                    </select>
                                    </font>
                                </td>
                              </tr>

                              <tr>
                                <td><font face="Arial, Helvetica, sans-serif">DD No:</font></td>
                                <td><input name="ddno" type="text" id="ddno" size="14" maxlength="12"></td>
                              </tr>

                              <tr>
                                <td><font face="Arial, Helvetica, sans-serif">DD Date (YYYY-MM-DD):</font></td>
                                <td><input name="ddate" type="text" id="ddate" size="14" maxlength="12"></td>
                              </tr>

                              <tr>
                                <td><font face="Arial, Helvetica, sans-serif">Challan No:</font></td>
                                <td><input name="challanno" type="text" id="challanno" size="14" maxlength="12"></td>
                              </tr>

                              <tr>
                                <td><font face="Arial, Helvetica, sans-serif">Bank:</font></td>
                                <td><input name="bankname" type="text" id="bankname" size="50" maxlength="50"></td>
                              </tr>

                              <tr>
                                <td colspan="2">
                                    <div align="center">
                                    <font face="Verdana, Arial, Helvetica, sans-serif">
                                        <strong>Mess Dues and Institute Fees Paid:</strong> <input name="allcheck" id="allcheck" type="checkbox" value="1"/></font>
                                  </div>
                                </td>
                              </tr>
                            
                              <tr>
                                <td width="243"><font face="Arial, Helvetica, sans-serif">Password:</font></td>
                                <td width="437"><input name="passwd" type="password" id="passwd" size="20" maxlength="15"></td>
                              </tr>
                            
                              <tr>
                                <td><input id="updatethis" name="updatethis" type="hidden"/></td>
                                <td><input type="submit" name="Submit" value="Update!"></td>
                              </tr>
                            </table>
                          </form>
                    

       <script language="JavaScript" type="text/javascript">

    function DoCustomCheck()
   {
        var frm = document.forms["updater"];
        
        if(frm.allcheck.checked)
        {
            return true;
        }
        else
        {
            alert('Please confirm payment by selecting checkbox!');
            return false;
        }
    }
      
  var frmvalidator  = new Validator("updater");
  frmvalidator.addValidation("userid","req","Please enter the studentID");
  frmvalidator.addValidation("userid","maxlen=6","Invalid studentID");
  frmvalidator.addValidation("userid","minlen=6","Invalid studentID");
  frmvalidator.addValidation("userid","numeric","Invalid studentID");
  
  frmvalidator.addValidation("fee","req");
  
  frmvalidator.addValidation("ddno","numeric","Invalid DDNo");
  frmvalidator.addValidation("ddno","req","Please enter DDNo");
  
  frmvalidator.addValidation("ddate","req","Please fill the DD-Date");
  frmvalidator.addValidation("ddate","regexp=^(2006|2007)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$", "Invalid Date, use the YYYY-MM-DD format!");
  
  frmvalidator.addValidation("challanno","req", "Please fill the ChallanNo");
  frmvalidator.addValidation("challanno","numeric", "Invalid ChallanNo");
  frmvalidator.addValidation("bankname","req", "Please fill the bank name");

  frmvalidator.addValidation("passwd","req", "Please enter the password!");

  frmvalidator.setAddnlValidationFunction("DoCustomCheck");
        </script>

                          <p>&nbsp;</p>

                          <p>&nbsp;</p>
                        </td>

                        <td bgcolor="#E0E0E0" valign="top">&nbsp;</td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>

  <center>
    <small><b>&#169; 2005 Malaviya National Institute of Technology</b></small>
  </center>
</body>

<?php
    } else {
        if (isset($_POST['passwd']) and ($_POST['passwd'] == 'rhelesv4')) {
            if (isset($_POST['userid']) and isset($_POST['fee']) and isset($_POST['ddno']) and isset($_POST['ddate']) and isset($_POST['challanno']) and isset($_POST['bankname']) and isset($_POST['allcheck']) and ($_POST['allcheck'] == 1)) {
                $conn = mysql_connect('localhost', 'root', 'password');
                mysql_select_db('mnit_temp');
                mysql_query("UPDATE students SET duespaid = 'Y',
                                                    category = '".$_POST['fee']."',
                                                        ddno = ".intval($_POST['ddno']).",
                                                            ddate = '".$_POST['ddate']."',
                                                                challan = ".$_POST['challanno'].",
                                                                    bank = '".mysql_real_escape_string($_POST['bankname'])."'
                                             WHERE userid = '".$_POST['userid']."'") or die(mysql_error());
                echo "Student Updated! <a href=\"update.php\">Next</a>";  
            } else {
                echo "You forgot to check the box! Go back to fix...</a>";
            }
        } else {
            echo "INVALID PASSWORD! <a href=\"update.php\">Try Again</a>";
        }     
   }
?>
</html>
